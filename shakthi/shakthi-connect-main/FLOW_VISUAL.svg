<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="2400" viewBox="0 0 1600 2400">
  <defs>
    <style>
      .start { fill: #4CAF50; }
      .process { fill: #2196F3; }
      .decision { fill: #FF9800; }
      .worker { fill: #9C27B0; }
      .customer { fill: #F44336; }
      .end { fill: #4CAF50; }
      .text { font-family: Arial, sans-serif; font-size: 12px; fill: white; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #333; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; fill: #666; }
      .arrow { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .dashedArrow { stroke: #999; stroke-width: 2; fill: none; stroke-dasharray: 5,5; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="800" y="40" class="title">SHAKTHI CONNECT — Complete User Flow</text>
  <text x="800" y="60" class="subtitle">From Signup to Job Completion</text>

  <!-- PHASE 1: ONBOARDING -->
  <g id="phase1">
    <text x="100" y="100" class="subtitle" style="text-anchor: start; fill: #1976D2; font-weight: bold;">PHASE 1: ONBOARDING &amp; AUTHENTICATION</text>
    
    <!-- Step 1: Language Select -->
    <rect x="50" y="130" width="200" height="60" rx="5" class="start"/>
    <text x="150" y="160" class="text">Step 1: Language</text>
    <text x="150" y="175" class="text">Select (/ )</text>

    <!-- Arrow -->
    <path d="M 150 190 L 150 220" class="arrow"/>

    <!-- Step 2: OTP Login -->
    <rect x="50" y="220" width="200" height="80" rx="5" class="process"/>
    <text x="150" y="250" class="text">Step 2: OTP Login</text>
    <text x="150" y="265" class="text">/login</text>
    <text x="150" y="280" class="text">Phone + OTP</text>

    <!-- Arrow -->
    <path d="M 150 300 L 150 330" class="arrow"/>

    <!-- Step 3: Dashboard -->
    <rect x="50" y="330" width="200" height="60" rx="5" class="process"/>
    <text x="150" y="360" class="text">Step 3: Dashboard</text>
    <text x="150" y="375" class="text">/dashboard</text>

    <!-- Arrow -->
    <path d="M 250 360 L 300 360" class="arrow"/>
  </g>

  <!-- PHASE 2: PROFILE SETUP -->
  <g id="phase2">
    <text x="350" y="100" class="subtitle" style="text-anchor: start; fill: #1976D2; font-weight: bold;">PHASE 2: PROFILE SETUP</text>
    
    <!-- Step 4: Profile -->
    <rect x="300" y="130" width="180" height="60" rx="5" class="process"/>
    <text x="390" y="160" class="text">Step 4: Profile</text>
    <text x="390" y="175" class="text">/profile</text>

    <!-- Arrow -->
    <path d="M 390 190 L 390 220" class="arrow"/>

    <!-- Step 5: Skills -->
    <rect x="300" y="220" width="180" height="60" rx="5" class="process"/>
    <text x="390" y="250" class="text">Step 5: Add Skills</text>
    <text x="390" y="275" class="text">/skills</text>

    <!-- Arrow -->
    <path d="M 390 280 L 390 330" class="arrow"/>
  </g>

  <!-- DECISION POINT -->
  <g id="decision">
    <!-- Diamond -->
    <polygon points="650,330 750,250 850,330 750,410" class="decision"/>
    <text x="750" y="340" class="text">Ready to</text>
    <text x="750" y="355" class="text">Work?</text>

    <!-- Arrow from profile setup -->
    <path d="M 480 360 L 650 330" class="arrow"/>
  </g>

  <!-- PHASE 3A: WORKER PATH -->
  <g id="phase3a">
    <text x="50" y="500" class="subtitle" style="text-anchor: start; fill: #9C27B0; font-weight: bold;">PHASE 3A: WORKER PATH (Take Work)</text>

    <!-- Arrow from decision -->
    <path d="M 650 370 L 250 450" class="arrow"/>

    <!-- Step 6A: Browse Jobs -->
    <rect x="50" y="450" width="200" height="70" rx="5" class="worker"/>
    <text x="150" y="480" class="text">Step 6A:</text>
    <text x="150" y="495" class="text">Browse Jobs</text>
    <text x="150" y="510" class="text">/take-work</text>

    <!-- Arrow -->
    <path d="M 150 520 L 150 560" class="arrow"/>

    <!-- Step 7A: Apply -->
    <rect x="50" y="560" width="200" height="70" rx="5" class="worker"/>
    <text x="150" y="590" class="text">Step 7A:</text>
    <text x="150" y="605" class="text">Apply for Job</text>
    <text x="150" y="620" class="text">[POST /apply]</text>

    <!-- Arrow -->
    <path d="M 150 630 L 150 670" class="arrow"/>

    <!-- Step 8A: View Applications -->
    <rect x="50" y="670" width="200" height="80" rx="5" class="worker"/>
    <text x="150" y="700" class="text">Step 8A:</text>
    <text x="150" y="715" class="text">View My Tasks</text>
    <text x="150" y="730" class="text">/my-tasks</text>
    <text x="150" y="745" class="text">Status: Pending</text>

    <!-- Arrow -->
    <path d="M 150 750 L 150 790" class="arrow"/>
  </g>

  <!-- PHASE 3B: CUSTOMER PATH -->
  <g id="phase3b">
    <text x="1050" y="500" class="subtitle" style="text-anchor: start; fill: #F44336; font-weight: bold;">PHASE 3B: CUSTOMER PATH (Give Work)</text>

    <!-- Arrow from decision -->
    <path d="M 850 370 L 1350 450" class="arrow"/>

    <!-- Step 6B: Post Job -->
    <rect x="1250" y="450" width="200" height="70" rx="5" class="customer"/>
    <text x="1350" y="480" class="text">Step 6B:</text>
    <text x="1350" y="495" class="text">Post Job</text>
    <text x="1350" y="510" class="text">/give-work</text>

    <!-- Arrow -->
    <path d="M 1350 520 L 1350 560" class="arrow"/>

    <!-- Step 7B: View Applications -->
    <rect x="1250" y="560" width="200" height="80" rx="5" class="customer"/>
    <text x="1350" y="590" class="text">Step 7B:</text>
    <text x="1350" y="605" class="text">View Applications</text>
    <text x="1350" y="620" class="text">/my-postings</text>
    <text x="1350" y="635" class="text">[Pending Apps]</text>

    <!-- Arrow -->
    <path d="M 1350 640 L 1350 680" class="arrow"/>

    <!-- Step 8B: Accept/Reject -->
    <rect x="1250" y="680" width="200" height="80" rx="5" class="customer"/>
    <text x="1350" y="710" class="text">Step 8B:</text>
    <text x="1350" y="725" class="text">Accept/Reject</text>
    <text x="1350" y="740" class="text">[POST /accept]</text>
    <text x="1350" y="755" class="text">Job: LOCKED</text>

    <!-- Arrow -->
    <path d="M 1350 760 L 1350 800" class="arrow"/>
  </g>

  <!-- MATCHED STATE (convergence) -->
  <g id="matched">
    <!-- Convergence box -->
    <rect x="650" y="790" width="300" height="120" rx="5" style="fill: #E3F2FD; stroke: #1976D2; stroke-width: 2;"/>
    <text x="800" y="815" class="subtitle" style="fill: #1976D2; font-weight: bold;">MATCHED STATE</text>
    <text x="800" y="835" class="subtitle" style="fill: #333; font-size: 11px;">Job LOCKED with Assigned Worker</text>
    <text x="800" y="850" class="subtitle" style="fill: #333; font-size: 11px;">Both can Chat & Collaborate</text>

    <!-- Arrows from both paths -->
    <path d="M 250 750 L 650 850" class="dashedArrow"/>
    <path d="M 1250 750 L 950 850" class="dashedArrow"/>
  </g>

  <!-- PHASE 4: COLLABORATION -->
  <g id="phase4">
    <text x="50" y="980" class="subtitle" style="text-anchor: start; fill: #1976D2; font-weight: bold;">PHASE 4: COLLABORATION &amp; COMPLETION</text>

    <!-- Step 9: Chat -->
    <rect x="600" y="950" width="200" height="70" rx="5" class="process"/>
    <text x="700" y="980" class="text">Step 9: Chat</text>
    <text x="700" y="995" class="text">/chat/:job_id</text>
    <text x="700" y="1010" class="text">[GET/POST msgs]</text>

    <!-- Arrow from matched -->
    <path d="M 800 910 L 700 950" class="arrow"/>

    <!-- Arrow -->
    <path d="M 700 1020 L 700 1050" class="arrow"/>

    <!-- Step 10: Complete & Rate -->
    <rect x="600" y="1050" width="200" height="80" rx="5" class="process"/>
    <text x="700" y="1080" class="text">Step 10: Complete</text>
    <text x="700" y="1095" class="text">&amp; Rate Job</text>
    <text x="700" y="1110" class="text">[POST /complete]</text>
    <text x="700" y="1125" class="text">Status: COMPLETED</text>

    <!-- Arrow -->
    <path d="M 700 1130 L 700 1170" class="arrow"/>

    <!-- Step 11: History -->
    <rect x="600" y="1170" width="200" height="70" rx="5" class="process"/>
    <text x="700" y="1200" class="text">Step 11: View</text>
    <text x="700" y="1215" class="text">History</text>
    <text x="700" y="1230" class="text">/history</text>

    <!-- Arrow -->
    <path d="M 700 1240 L 700 1280" class="arrow"/>
  </g>

  <!-- PHASE 5: REWARDS & LOOP -->
  <g id="phase5">
    <text x="50" y="1330" class="subtitle" style="text-anchor: start; fill: #1976D2; font-weight: bold;">PHASE 5: COMPLETION &amp; CONTINUOUS LOOP</text>

    <!-- Rewards box -->
    <rect x="600" y="1280" width="200" height="120" rx="5" style="fill: #FFF9C4; stroke: #F57F17; stroke-width: 2;"/>
    <text x="700" y="1305" class="subtitle" style="fill: #F57F17; font-weight: bold;">REWARDS</text>
    <text x="700" y="1325" class="text">✓ Credits Added</text>
    <text x="700" y="1340" class="text">✓ Rating Updated</text>
    <text x="700" y="1355" class="text">✓ Notifications</text>
    <text x="700" y="1370" class="text">✓ History Recorded</text>

    <!-- Step 12: Notifications -->
    <rect x="600" y="1430" width="200" height="70" rx="5" class="process"/>
    <text x="700" y="1460" class="text">Step 12:</text>
    <text x="700" y="1475" class="text">Notifications Hub</text>
    <text x="700" y="1490" class="text">[GET /notifications]</text>

    <!-- Arrow -->
    <path d="M 700 1500 L 700 1540" class="arrow"/>

    <!-- Step 13: Settings -->
    <rect x="600" y="1540" width="200" height="70" rx="5" class="process"/>
    <text x="700" y="1570" class="text">Step 13: Update</text>
    <text x="700" y="1585" class="text">Settings</text>
    <text x="700" y="1600" class="text">/settings</text>

    <!-- Arrow -->
    <path d="M 700 1610 L 700 1650" class="arrow"/>

    <!-- Step 14: Explore Nearby -->
    <rect x="600" y="1650" width="200" height="70" rx="5" class="process"/>
    <text x="700" y="1680" class="text">Step 14: Explore</text>
    <text x="700" y="1695" class="text">Nearby</text>
    <text x="700" y="1710" class="text">/near-me</text>

    <!-- Arrow for loop -->
    <path d="M 600 1685 L 400 1685 L 400 480 L 250 480" class="dashedArrow" stroke-dasharray="5,5"/>
    <text x="350" y="1070" class="subtitle" style="fill: #666; font-size: 11px;">REPEAT:</text>
    <text x="350" y="1085" class="subtitle" style="fill: #666; font-size: 11px;">Next Job Cycle</text>
  </g>

  <!-- DATA FLOW -->
  <g id="dataflow">
    <text x="50" y="1800" class="subtitle" style="text-anchor: start; fill: #1976D2; font-weight: bold;">KEY API CALLS &amp; DATA FLOW</text>

    <!-- Left column -->
    <rect x="50" y="1830" width="300" height="200" rx="5" style="fill: #F3E5F5; stroke: #7B1FA2; stroke-width: 1;"/>
    <text x="200" y="1855" class="subtitle" style="fill: #7B1FA2; text-anchor: middle;">WORKER ENDPOINTS</text>
    
    <text x="70" y="1875" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/jobs/:id/apply</text>
    <text x="70" y="1895" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Request: {workerId}</text>
    <text x="70" y="1910" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Response: Application + Job</text>

    <text x="70" y="1930" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/my-applications</text>
    <text x="70" y="1950" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Response: Jobs with status</text>

    <text x="70" y="1970" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/messages</text>
    <text x="70" y="1990" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Send/Receive chat messages</text>

    <!-- Center column -->
    <rect x="400" y="1830" width="300" height="200" rx="5" style="fill: #E8F5E9; stroke: #388E3C; stroke-width: 1;"/>
    <text x="550" y="1855" class="subtitle" style="fill: #388E3C; text-anchor: middle;">SHARED ENDPOINTS</text>
    
    <text x="420" y="1875" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/send-otp</text>
    <text x="420" y="1895" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Phone → OTP (123456)</text>

    <text x="420" y="1915" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/login</text>
    <text x="420" y="1935" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Returns: User object</text>

    <text x="420" y="1955" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ GET /api/notifications</text>
    <text x="420" y="1975" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Real-time alerts</text>

    <!-- Right column -->
    <rect x="750" y="1830" width="300" height="200" rx="5" style="fill: #FCE4EC; stroke: #C2185B; stroke-width: 1;"/>
    <text x="900" y="1855" class="subtitle" style="fill: #C2185B; text-anchor: middle;">CUSTOMER ENDPOINTS</text>
    
    <text x="770" y="1875" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/jobs</text>
    <text x="770" y="1895" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Request: Job details</text>
    <text x="770" y="1910" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Response: New job object</text>

    <text x="770" y="1930" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/my-postings</text>
    <text x="770" y="1950" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Jobs + Applications array</text>

    <text x="770" y="1970" class="subtitle" style="text-anchor: start; fill: #333; font-size: 11px; font-weight: bold;">→ POST /api/applications/:id/accept</text>
    <text x="770" y="1990" class="subtitle" style="text-anchor: start; fill: #666; font-size: 10px;">Accept worker application</text>
  </g>

  <!-- JOB STATUS TRANSITIONS -->
  <g id="jobstatus">
    <text x="50" y="2070" class="subtitle" style="text-anchor: start; fill: #1976D2; font-weight: bold;">JOB STATUS LIFECYCLE</text>

    <rect x="50" y="2100" width="100" height="50" rx="5" style="fill: #4CAF50; stroke: #2E7D32; stroke-width: 2;"/>
    <text x="100" y="2135" class="text" style="font-size: 14px; font-weight: bold;">OPEN</text>

    <path d="M 150 2125 L 200 2125" class="arrow"/>
    <text x="175" y="2115" class="subtitle" style="text-anchor: middle; fill: #666; font-size: 10px;">Worker applies</text>

    <rect x="200" y="2100" width="100" height="50" rx="5" style="fill: #FF9800; stroke: #E65100; stroke-width: 2;"/>
    <text x="250" y="2135" class="text" style="font-size: 14px; font-weight: bold;">ON_HOLD</text>

    <path d="M 300 2125 L 350 2125" class="arrow"/>
    <text x="325" y="2115" class="subtitle" style="text-anchor: middle; fill: #666; font-size: 10px;">Customer accepts</text>

    <rect x="350" y="2100" width="100" height="50" rx="5" style="fill: #2196F3; stroke: #1565C0; stroke-width: 2;"/>
    <text x="400" y="2135" class="text" style="font-size: 14px; font-weight: bold;">LOCKED</text>

    <path d="M 450 2125 L 500 2125" class="arrow"/>
    <text x="475" y="2115" class="subtitle" style="text-anchor: middle; fill: #666; font-size: 10px;">Job completed</text>

    <rect x="500" y="2100" width="100" height="50" rx="5" style="fill: #4CAF50; stroke: #2E7D32; stroke-width: 2;"/>
    <text x="550" y="2130" class="text" style="font-size: 12px; font-weight: bold;">COMPLETED</text>
    <text x="550" y="2145" class="text" style="font-size: 10px;">✓ Rated</text>

    <!-- Alternative path -->
    <path d="M 250 2100 L 250 2200 L 100 2200 L 100 2150" class="dashedArrow"/>
    <text x="180" y="2190" class="subtitle" style="text-anchor: middle; fill: #666; font-size: 10px;">All rejected</text>

    <!-- Rejection path -->
    <path d="M 400 2100 L 400 2220 L 250 2220 L 250 2150" class="dashedArrow"/>
    <text x="330" y="2210" class="subtitle" style="text-anchor: middle; fill: #666; font-size: 10px;">Customer rejects</text>
  </g>

  <!-- Legend -->
  <g id="legend">
    <text x="50" y="2310" class="subtitle" style="text-anchor: start; fill: #1976D2; font-weight: bold;">LEGEND</text>

    <rect x="50" y="2330" width="30" height="30" rx="3" class="start"/>
    <text x="100" y="2350" class="subtitle" style="text-anchor: start; fill: #333;">Start/Entry Point</text>

    <rect x="50" y="2370" width="30" height="30" rx="3" class="process"/>
    <text x="100" y="2390" class="subtitle" style="text-anchor: start; fill: #333;">Process/Action</text>

    <rect x="350" y="2330" width="30" height="30" rx="3" class="worker"/>
    <text x="400" y="2350" class="subtitle" style="text-anchor: start; fill: #333;">Worker Path</text>

    <rect x="350" y="2370" width="30" height="30" rx="3" class="customer"/>
    <text x="400" y="2390" class="subtitle" style="text-anchor: start; fill: #333;">Customer Path</text>
  </g>
</svg>